{% extends 'base.html' %}

{% block title %}
SongScaffolder
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-4 header-col">
            <div class="p-2 lead text-center">Randomize These!</div>
        </div>
        <div class="col-4 header-col">
            <div class="p-2 lead text-center">I Want This Many.</div>
        </div>
        <div class="col-4 header-col">
            <div class="p-2 lead text-center">Here's My Specs.</div>
        </div>
    </div>
    <hr>

    <div class="row zero-row">
        <div class="col-4 first-col"></div>
        <div class="col-4 second-col d-flex justify-content-center">
            <p class="get-help h3 text-center" id="get-help-for-quantity">
                <i class="fa fa-question-circle" data-toggle="tooltip" data-placement="right" title="Determines how many items from the corresponding field you want to include."></i>
            </p>
        </div>
        <div class="col-4 third-col"></div>
    </div>

    {% if fields %}
        {% for field in fields %}
            <div class="row first-row">
                <div class="col-4 first-col">
                    <div class="row">
                        <div class="col-7 text-right">
                            <p class="center">{{ field.title }}</p>
                        </div>
                        <div class="col-2">
                            <label class="switch">
                                <input type="checkbox" id="switch-include_{{ field.id }}">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="col-3" >
                            <!-- Generated markup by the plugin -->
                            <p class="get-help h3 text-center">
                                <i class="fa fa-question-circle" class="get-help h3 text-center" data-toggle="tooltip" data-placement="right" data-html="true" title="{{ field.info }}" id="get-help-with-randomizing_{{ field.id }}"></i>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-4 second-col d-flex justify-content-center" >
                    <form>
                        <input type="text" class="no-border border-bottom text-center" id="quantity-for+{{ field.id }}"><br><br>
                    </form>
                </div>
                <div class="col-4 third-col">
                    <div class="row">
                        <div class="col-2"><a class="fa fa-list" id="define-specs-for_{{ field.id }}" href="{% url 'field:config' field.id %}"></a></div>
                        <div class="col-3"><p class="h3 text-center"><i class="fa fa-question-circle" id="get-help-with-specifying_{{ field.id }}"></i></p></div>
                    </div>
                </div>
            </div>
        {% endfor %}
    {% endif %}

    <div class="row last-row">
        <div class="col-2">
        </div>
        <div class="col-8">
            <button class="btn btn-lg btn-block btn-green" id="btn-make-scaffold" data-toggle="modal" data-target=".bd-example-modal-lg">SCAFFOLD THAT SONG</button>
        </div>
        <div class="col-2">
        </div>
    </div>

    <div class="container-fluid">
    <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="jumbotron">
                    <h4 class="display-4 text-center"> 12/08/19 </h4>
                    <table class="table table-striped">
                        <tbody>
                            <tr>
                                <td>Chords</td>
                                <td>5, aug, 7no3</td>
                            </tr>
                                <tr>
                                <td>Feels</td>
                                <td>Swingy, Moody, Bad</td>
                            </tr>
                                <tr>
                                <td>Instruments</td>
                                <td>Guitar, Piano, Flex</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Eventually I want to remove this call to jQuery, since I think it should only be done in base.html.  -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <script>
        fields = {

        }
        fieldElements = $('input[type="checkbox"]')
        console.log(fieldElements);
        for (i=0 ; i < fieldElements.length; i++){
            name = fieldElements[i].id.split("_")[1]
            if (fieldElements[i].checked == true) {
                fields[name] = true;
            }
            else {
                fields[name] = false;
            }
        }
        console.log(fields);

        $("#btn-make-scaffold").on("click", function() {
            $.ajax({
                type: "GET",
                url: "{% url 'pages:make-scaffold' %}",
                dataType: "json",
                data: {
                    "fields": JSON.stringify(fields)
                },
                success(data){
                    console.log(data);
                },
                failure(data){
                    console.log("failed!");
                }
            });
        });
    </script>
{% endblock %}